<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joachim Ndhokero- 4408804 and Nomin Batbayar - 442627">
<meta name="dcterms.date" content="2023-06-16">

<title>Credit Scoring Classification Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="RRproj_files/libs/clipboard/clipboard.min.js"></script>
<script src="RRproj_files/libs/quarto-html/quarto.js"></script>
<script src="RRproj_files/libs/quarto-html/popper.min.js"></script>
<script src="RRproj_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RRproj_files/libs/quarto-html/anchor.min.js"></script>
<link href="RRproj_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RRproj_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RRproj_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RRproj_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RRproj_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Credit Scoring Classification Analysis</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Joachim Ndhokero- 4408804 and Nomin Batbayar - 442627 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 16, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#importing-neccessary-libraries" id="toc-importing-neccessary-libraries" class="nav-link" data-scroll-target="#importing-neccessary-libraries">Importing Neccessary Libraries</a></li>
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  </ul></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing">Data Preprocessing</a>
  <ul class="collapse">
  <li><a href="#treating-missing-data" id="toc-treating-missing-data" class="nav-link" data-scroll-target="#treating-missing-data">Treating Missing Data</a></li>
  <li><a href="#data-type" id="toc-data-type" class="nav-link" data-scroll-target="#data-type">Data type</a></li>
  </ul></li>
  <li><a href="#data-exploration-feature-selection" id="toc-data-exploration-feature-selection" class="nav-link" data-scroll-target="#data-exploration-feature-selection">Data Exploration &amp; Feature Selection</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this project we applied 3 machine learning classification algorithms to build model to predict Credit scores. The dataset we used for this project is Credit scoring dataset from <a href="https://www.kaggle.com/datasets/parisrohan/credit-score-classification">kaggle</a>.</p>
<section id="importing-neccessary-libraries" class="level3">
<h3 class="anchored" data-anchor-id="importing-neccessary-libraries">Importing Neccessary Libraries</h3>
<p>Following libraries are used for this project</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> scale</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder, OneHotEncoder</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<p>Initial dimension of the data had 100’000 rows and 28 variables. After removing some unique identification variables we are going to work on are:</p>
<ul>
<li>“Month” - Month of the year</li>
<li>“Age” - Age of the person, We limited it into 14+56</li>
<li>“Occupation” - Occupation of the person, 16 factor</li>
<li>“Annual_Income” - Annual income of the person, continuous variable</li>
<li>“Monthly_Inhand_Salary” - Monthly salary, continuous variable</li>
<li>“Num_Bank_Accounts” - Num of bank accounts the person holds</li>
<li>“Num_Credit_Card” - Num of credit card the person holds</li>
<li>“Interest_Rate” - Interest rate on credit card</li>
<li>“Num_of_Loan” - Num of loans from the bank</li>
<li>“Type_of_Loan” - Type of loan</li>
<li>“Delay_from_due_date” - Average number of days delayed from the payment date</li>
<li>“Num_of_Delayed_Payment” - Average number of payments delayed by a person</li>
<li>“Changed_Credit_Limit” - Percentage change in credit card limit</li>
<li>“Num_Credit_Inquiries” - number of credit card inquiries</li>
<li>“Credit_Mix” - Classification of the mix of credits</li>
<li>“Outstanding_Debt” - remaining debt to be paid (in USD)</li>
<li>“Credit_Utilization_Ratio” - utilization ratio of credit card</li>
<li>“Credit_History_Age” - age of credit history of the person</li>
<li>“Payment_of_Min_Amount” - whether only the minimum amount was paid by the person</li>
<li>“Total_EMI_per_month” - monthly EMI payments (in USD)</li>
<li>“Amount_invested_monthly” - monthly amount invested by the customer (in USD)</li>
<li>“Payment_Behaviour” - payment behavior of the customer</li>
<li>“Monthly_Balance” - monthly balance amount of the customer (in USD)</li>
<li>“Credit_Score” - bracket of credit score (Poor, Standard, Good)</li>
</ul>
<p>Our target variable Credit_Score has 3 classes, but we only took <strong>“Poor”</strong> and <strong>“Good”</strong> categories to further analysis.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>os.getcwd()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>credit_score<span class="op">=</span>pd.read_csv(<span class="st">'train.csv'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>credit_score<span class="op">=</span>credit_score.drop([<span class="st">'ID'</span>,<span class="st">'Name'</span>,<span class="st">'SSN'</span>], axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># remove unnecessary unique identifier columns</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>credit_score<span class="op">=</span>credit_score[credit_score.Credit_Score<span class="op">!=</span><span class="st">'Standard'</span>] <span class="co"># filter target variable and drop Standard category</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(credit_score.shape)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>credit_score.head()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(46826, 25)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Customer_ID</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Occupation</th>
<th data-quarto-table-cell-role="th">Annual_Income</th>
<th data-quarto-table-cell-role="th">Monthly_Inhand_Salary</th>
<th data-quarto-table-cell-role="th">Num_Bank_Accounts</th>
<th data-quarto-table-cell-role="th">Num_Credit_Card</th>
<th data-quarto-table-cell-role="th">Interest_Rate</th>
<th data-quarto-table-cell-role="th">Num_of_Loan</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Credit_Mix</th>
<th data-quarto-table-cell-role="th">Outstanding_Debt</th>
<th data-quarto-table-cell-role="th">Credit_Utilization_Ratio</th>
<th data-quarto-table-cell-role="th">Credit_History_Age</th>
<th data-quarto-table-cell-role="th">Payment_of_Min_Amount</th>
<th data-quarto-table-cell-role="th">Total_EMI_per_month</th>
<th data-quarto-table-cell-role="th">Amount_invested_monthly</th>
<th data-quarto-table-cell-role="th">Payment_Behaviour</th>
<th data-quarto-table-cell-role="th">Monthly_Balance</th>
<th data-quarto-table-cell-role="th">Credit_Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CUS_0xd40</td>
<td>January</td>
<td>23</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>...</td>
<td>_</td>
<td>809.98</td>
<td>26.822620</td>
<td>22 Years and 1 Months</td>
<td>No</td>
<td>49.574949</td>
<td>80.41529543900253</td>
<td>High_spent_Small_value_payments</td>
<td>312.49408867943663</td>
<td>Good</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUS_0xd40</td>
<td>February</td>
<td>23</td>
<td>Scientist</td>
<td>19114.12</td>
<td>NaN</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>31.944960</td>
<td>NaN</td>
<td>No</td>
<td>49.574949</td>
<td>118.28022162236736</td>
<td>Low_spent_Large_value_payments</td>
<td>284.62916249607184</td>
<td>Good</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUS_0xd40</td>
<td>March</td>
<td>-500</td>
<td>Scientist</td>
<td>19114.12</td>
<td>NaN</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>28.609352</td>
<td>22 Years and 3 Months</td>
<td>No</td>
<td>49.574949</td>
<td>81.699521264648</td>
<td>Low_spent_Medium_value_payments</td>
<td>331.2098628537912</td>
<td>Good</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUS_0xd40</td>
<td>April</td>
<td>23</td>
<td>Scientist</td>
<td>19114.12</td>
<td>NaN</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>31.377862</td>
<td>22 Years and 4 Months</td>
<td>No</td>
<td>49.574949</td>
<td>199.4580743910713</td>
<td>Low_spent_Small_value_payments</td>
<td>223.45130972736786</td>
<td>Good</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUS_0xd40</td>
<td>May</td>
<td>23</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>24.797347</td>
<td>22 Years and 5 Months</td>
<td>No</td>
<td>49.574949</td>
<td>41.420153086217326</td>
<td>High_spent_Medium_value_payments</td>
<td>341.48923103222177</td>
<td>Good</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing">Data Preprocessing</h2>
<p>We prepared the data set for further analysis step by transforming character variables into categorical/factor variables, and numeric variables, treating missing values, and standardized it and treating outliers.</p>
<p>We have noticed there is some strange values like “_“,”!<span class="citation" data-cites="9">@9</span>#%8”, “#F%$D@*&amp;8” in dataset. You can check the coding part below for details.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> replace_weird(credit_score): <span class="co"># create function for remove _ syntax</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> credit_score <span class="kw">is</span> np.NaN <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(credit_score, <span class="bu">str</span>):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> credit_score</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(credit_score).strip(<span class="st">'_ ,"'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>credit_score <span class="op">=</span> credit_score.applymap(replace_weird).replace([<span class="st">''</span>, <span class="st">'nan'</span>, <span class="st">'!@9#%8'</span>, <span class="st">'#F%$D@*&amp;8'</span>], np.NaN) <span class="co"># replace weird strings with na</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="treating-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="treating-missing-data">Treating Missing Data</h3>
<p>Below we can see that there is quite many missing data in our dataset. Removing them would result significant drop in our number of datasets. So that we need to try treating it as much as we can.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>credit_score.isna().<span class="bu">sum</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Customer_ID                    0
Month                          0
Age                            0
Occupation                  3274
Annual_Income                  0
Monthly_Inhand_Salary       7115
Num_Bank_Accounts              0
Num_Credit_Card                0
Interest_Rate                  0
Num_of_Loan                    0
Type_of_Loan                4780
Delay_from_due_date            0
Num_of_Delayed_Payment      3257
Changed_Credit_Limit        1000
Num_Credit_Inquiries         902
Credit_Mix                  9491
Outstanding_Debt               0
Credit_Utilization_Ratio       0
Credit_History_Age          4206
Payment_of_Min_Amount          0
Total_EMI_per_month            0
Amount_invested_monthly     2155
Payment_Behaviour           3608
Monthly_Balance              595
Credit_Score                   0
dtype: int64</code></pre>
</div>
</div>
<p>Below shows that we have dataset which includes credit scoring history of 8’692 unique customers January to August. Using Customer_Id, we can replace some feature’s missing value of certain customers, if other values are not missing.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>num_customer<span class="op">=</span> <span class="bu">len</span>(<span class="bu">set</span>(credit_score[<span class="st">"Customer_ID"</span>] ))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of unique customer: "</span>, num_customer)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>num_month<span class="op">=</span> <span class="bu">set</span>(credit_score[<span class="st">"Month"</span>] )</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of month: "</span>, num_month)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of unique customer:  8692
Number of month:  {'January', 'April', 'July', 'May', 'August', 'June', 'February', 'March'}</code></pre>
</div>
</div>
<p>For example, for Customer_ID=CUS_0x2dbc 3 of the value is missing. So instead of removing them we replaced the missing values with other most occured non missing value.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>credit_score[credit_score.Customer_ID<span class="op">==</span><span class="st">'CUS_0x2dbc'</span>].groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Occupation'</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Customer_ID
CUS_0x2dbc    [nan, Engineer, nan, Engineer, nan, Engineer]
Name: Occupation, dtype: object</code></pre>
</div>
</div>
<p>After replacing the missiong value of occupation, above example looks like this.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Occupation'</span>] <span class="op">=</span> credit_score[<span class="st">'Occupation'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Occupation'</span>].transform(<span class="kw">lambda</span> x: x.fillna(stats.mode(x)[<span class="dv">0</span>][<span class="dv">0</span>])))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>credit_score[credit_score.Customer_ID<span class="op">==</span><span class="st">'CUS_0x2dbc'</span>].groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Occupation'</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3119726562.py:1: FutureWarning:

Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3119726562.py:1: DeprecationWarning:

Support for non-numeric arrays has been deprecated as of SciPy 1.9.0 and will be removed in 1.11.0. `pandas.DataFrame.mode` can be used instead, see https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mode.html.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Customer_ID
CUS_0x2dbc    [nan, Engineer, nan, Engineer, nan, Engineer]
Name: Occupation, dtype: object</code></pre>
</div>
</div>
<p>With this method we also replaced missing values of categorical variables, Credit_Mix, Payment_Behaviour, Type_of_Loan.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Credit_Mix'</span>] <span class="op">=</span> credit_score[<span class="st">'Credit_Mix'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Credit_Mix'</span>].transform(<span class="kw">lambda</span> x: x.fillna(stats.mode(x)[<span class="dv">0</span>][<span class="dv">0</span>])))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Payment_Behaviour'</span>] <span class="op">=</span> credit_score[<span class="st">'Payment_Behaviour'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Payment_Behaviour'</span>].transform(<span class="kw">lambda</span> x: x.fillna(stats.mode(x)[<span class="dv">0</span>][<span class="dv">0</span>])))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Type_of_Loan'</span>] <span class="op">=</span> credit_score[<span class="st">'Type_of_Loan'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Type_of_Loan'</span>].transform(<span class="kw">lambda</span> x: x.fillna(stats.mode(x)[<span class="dv">0</span>][<span class="dv">0</span>])))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for credit history age we replaced with pervious or next month's value</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Credit_History_Age'</span>] <span class="op">=</span> credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Credit_History_Age'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.interpolate().bfill().ffill())</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:1: FutureWarning:

Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:1: DeprecationWarning:

Support for non-numeric arrays has been deprecated as of SciPy 1.9.0 and will be removed in 1.11.0. `pandas.DataFrame.mode` can be used instead, see https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mode.html.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:2: FutureWarning:

Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:2: DeprecationWarning:

Support for non-numeric arrays has been deprecated as of SciPy 1.9.0 and will be removed in 1.11.0. `pandas.DataFrame.mode` can be used instead, see https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mode.html.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:3: FutureWarning:

Unlike other reduction functions (e.g. `skew`, `kurtosis`), the default behavior of `mode` typically preserves the axis it acts along. In SciPy 1.11.0, this behavior will change: the default value of `keepdims` will become False, the `axis` over which the statistic is taken will be eliminated, and the value None will no longer be accepted. Set `keepdims` to True or False to avoid this warning.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:3: DeprecationWarning:

Support for non-numeric arrays has been deprecated as of SciPy 1.9.0 and will be removed in 1.11.0. `pandas.DataFrame.mode` can be used instead, see https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mode.html.

/var/folders/6h/yr9vftfx0xv6rz2_sdjvz1180000gn/T/ipykernel_42703/3462292945.py:5: FutureWarning:

Not prepending group keys to the result index of transform-like apply. In the future, the group keys will be included in the index, regardless of whether the applied function returns a like-indexed object.
To preserve the previous behavior, use

    &gt;&gt;&gt; .groupby(..., group_keys=False)

To adopt the future behavior and silence this warning, use 

    &gt;&gt;&gt; .groupby(..., group_keys=True)
</code></pre>
</div>
</div>
<p>As for numerical variables, we take average of other non missing values.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>credit_score[credit_score.Customer_ID<span class="op">==</span><span class="st">'CUS_0x1018'</span>].groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_of_Delayed_Payment'</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Customer_ID
CUS_0x1018    [22, 22, 22, 20, nan, 22, 22, 22]
Name: Num_of_Delayed_Payment, dtype: object</code></pre>
</div>
</div>
<p>After replacing the missiong value of Num_of_Delayed_Payment, above example looks like this.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_of_Delayed_Payment'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_of_Delayed_Payment'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_of_Delayed_Payment'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>credit_score[credit_score.Customer_ID<span class="op">==</span><span class="st">'CUS_0x1018'</span>].groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_of_Delayed_Payment'</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Customer_ID
CUS_0x1018    [22, 22, 22, 20, 21.714285714285715, 22, 22, 22]
Name: Num_of_Delayed_Payment, dtype: object</code></pre>
</div>
</div>
<p>And with this method, we do same for Monthly_Inhand_Salary, Changed_Credit_Limit, Num_Credit_Inquiries, Amount_invested_monthly, Monthly_Balance variables.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Monthly_Inhand_Salary'</span>] <span class="op">=</span> credit_score[<span class="st">'Monthly_Inhand_Salary'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Monthly_Inhand_Salary'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Changed_Credit_Limit'</span>] <span class="op">=</span> credit_score[<span class="st">'Changed_Credit_Limit'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Changed_Credit_Limit'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Credit_Inquiries'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_Credit_Inquiries'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_Credit_Inquiries'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.mean())))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Amount_invested_monthly'</span>] <span class="op">=</span> credit_score[<span class="st">'Amount_invested_monthly'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Amount_invested_monthly'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Monthly_Balance'</span>] <span class="op">=</span> credit_score[<span class="st">'Monthly_Balance'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Monthly_Balance'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After missing value treatment we have now left with very few missing value.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>credit_score.isna().<span class="bu">sum</span>()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Customer_ID                    0
Month                          0
Age                            0
Occupation                   158
Annual_Income                  0
Monthly_Inhand_Salary         85
Num_Bank_Accounts              0
Num_Credit_Card                0
Interest_Rate                  0
Num_of_Loan                    0
Type_of_Loan                4780
Delay_from_due_date            0
Num_of_Delayed_Payment        33
Changed_Credit_Limit           6
Num_Credit_Inquiries           5
Credit_Mix                  1629
Outstanding_Debt               0
Credit_Utilization_Ratio       0
Credit_History_Age            47
Payment_of_Min_Amount          0
Total_EMI_per_month            0
Amount_invested_monthly       19
Payment_Behaviour            748
Monthly_Balance                9
Credit_Score                   0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="data-type" class="level3">
<h3 class="anchored" data-anchor-id="data-type">Data type</h3>
<p>Here we are converting variables into suitable data types numeric or categorical.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">"Month"</span>] <span class="op">=</span> credit_score[<span class="st">"Month"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Age'</span>]<span class="op">=</span>credit_score[<span class="st">'Age'</span>].astype(<span class="st">'int'</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>credit_score.Occupation<span class="op">=</span>credit_score.Occupation.astype(<span class="st">'category'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>credit_score.Annual_Income<span class="op">=</span>credit_score.Annual_Income.astype(<span class="st">'float'</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>credit_score.Monthly_Inhand_Salary<span class="op">=</span>credit_score.Monthly_Inhand_Salary.astype(<span class="st">'float'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>credit_score.Num_Bank_Accounts<span class="op">=</span>credit_score.Num_Bank_Accounts.astype(<span class="st">'float'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>credit_score.Num_Credit_Card<span class="op">=</span>credit_score.Num_Credit_Card.astype(<span class="st">'float'</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>credit_score.Interest_Rate<span class="op">=</span>credit_score.Interest_Rate.astype(<span class="st">'float'</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>credit_score.Num_of_Loan<span class="op">=</span>credit_score.Num_of_Loan.astype(<span class="st">'int'</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>credit_score.Num_of_Delayed_Payment<span class="op">=</span>credit_score.Num_of_Delayed_Payment.astype(<span class="st">'float'</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>credit_score.Changed_Credit_Limit<span class="op">=</span>pd.to_numeric(credit_score.Changed_Credit_Limit, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>credit_score.Num_Credit_Inquiries<span class="op">=</span>pd.to_numeric(credit_score.Num_Credit_Inquiries, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>credit_score.Credit_Mix<span class="op">=</span>credit_score.Credit_Mix.astype(<span class="st">'category'</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>credit_score.Outstanding_Debt<span class="op">=</span>pd.to_numeric(credit_score.Outstanding_Debt, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>credit_score.Payment_of_Min_Amount<span class="op">=</span>credit_score.Payment_of_Min_Amount.astype(<span class="st">'category'</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>credit_score.Amount_invested_monthly<span class="op">=</span>pd.to_numeric(credit_score.Amount_invested_monthly, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>credit_score.Credit_Score<span class="op">=</span>credit_score.Credit_Score.astype(<span class="st">'category'</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>credit_score.Monthly_Balance<span class="op">=</span>pd.to_numeric(credit_score.Monthly_Balance, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="outlier-values" class="level4">
<h4 class="anchored" data-anchor-id="outlier-values">Outlier Values</h4>
<p>We check each numeric values if there is any outliers or wrong values by drawing the histogram of it and treat it individually. We clearly see that in Age, Annual_Income, Num_Bank_Account, Num_Credit_Card, Interest_Rate, Num_of_Loan, Num_of_Delayed_Payment, Num_Credit_Inquiries, Total_EMI_per_month, Amount_invested_monthly, Monthly_Balance has outliers or wrong values in it. We will fix it by using 1 and 3rd quantiles to make outlier values NAN and treat it same as the missing values.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fig, axis <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>credit_score.hist(ax<span class="op">=</span>axis, color <span class="op">=</span> <span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span> , grid<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="RRproj_files/figure-html/cell-15-output-1.png" width="826" height="818"></p>
</div>
</div>
<p>To get 1st and 3rd quantiles we will use below function.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_1_3_qr(credit_score, column, multiply<span class="op">=</span><span class="fl">1.5</span>):</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    q1 <span class="op">=</span> credit_score[column].quantile(<span class="fl">0.25</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    q3 <span class="op">=</span> credit_score[column].quantile(<span class="fl">0.75</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    iqr <span class="op">=</span> q3 <span class="op">-</span>q1</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    lower <span class="op">=</span> q1<span class="op">-</span>iqr<span class="op">*</span>multiply</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> q3<span class="op">+</span>iqr<span class="op">*</span>multiply</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Outlier band of'</span>, column, <span class="st">":"</span>, lower, <span class="st">";"</span>, upper)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For age, we can tell than below 0 and above 67 should be outlier value and we make such value NAN and then treat it same as we did for missing values.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Age'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Age'</span>]<span class="op">=</span>credit_score[<span class="st">'Age'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">67</span>)) <span class="cf">else</span> x)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Age'</span>] <span class="op">=</span> credit_score[<span class="st">'Age'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Age'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.hist(credit_score.Age, color <span class="op">=</span> <span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outlier band of Age : -3.0 ; 69.0</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="RRproj_files/figure-html/cell-17-output-2.png" width="583" height="411"></p>
</div>
</div>
<p>And we fixed the other variables with outliers using the same method.</p>
<ul>
<li>First identifying outlier bands:</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Annual_Income'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Num_Bank_Accounts'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Num_Credit_Inquiries'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Interest_Rate'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Num_of_Loan'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Num_of_Delayed_Payment'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Num_Credit_Card'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Total_EMI_per_month'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Amount_invested_monthly'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>get_1_3_qr(credit_score, <span class="st">'Monthly_Balance'</span>, multiply<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outlier band of Annual_Income : -59336.89750000001 ; 149059.0425
Outlier band of Num_Bank_Accounts : -4.5 ; 15.5
Outlier band of Num_Credit_Inquiries : -7.5 ; 20.5
Outlier band of Interest_Rate : -18.5 ; 49.5
Outlier band of Num_of_Loan : -4.0 ; 12.0
Outlier band of Num_of_Delayed_Payment : -8.5 ; 35.5
Outlier band of Num_Credit_Card : -0.5 ; 11.5
Outlier band of Total_EMI_per_month : -170.8962565708198 ; 373.8051122659707
Outlier band of Amount_invested_monthly : -219.46674583295186 ; 565.4620842502486
Outlier band of Monthly_Balance : -21.159846598012678 ; 744.2067826197436</code></pre>
</div>
</div>
<ul>
<li>Then replacing outlier variables with NAN:</li>
</ul>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Annual_Income'</span>]<span class="op">=</span>credit_score[<span class="st">'Annual_Income'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">149060</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Bank_Accounts'</span>]<span class="op">=</span>credit_score[<span class="st">'Num_Bank_Accounts'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">16</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Credit_Inquiries'</span>]<span class="op">=</span>credit_score[<span class="st">'Num_Credit_Inquiries'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">21</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Interest_Rate'</span>]<span class="op">=</span>credit_score[<span class="st">'Interest_Rate'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">50</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_of_Loan'</span>]<span class="op">=</span>credit_score[<span class="st">'Num_of_Loan'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">12</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_of_Delayed_Payment'</span>]<span class="op">=</span>credit_score[<span class="st">'Num_of_Delayed_Payment'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">36</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Credit_Card'</span>]<span class="op">=</span>credit_score[<span class="st">'Num_Credit_Card'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">12</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Total_EMI_per_month'</span>]<span class="op">=</span>credit_score[<span class="st">'Total_EMI_per_month'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">374</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Amount_invested_monthly'</span>]<span class="op">=</span>credit_score[<span class="st">'Amount_invested_monthly'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> ((x<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">|</span>(x<span class="op">&gt;</span><span class="dv">567</span>)) <span class="cf">else</span> x)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Monthly_Balance'</span>]<span class="op">=</span>credit_score[<span class="st">'Monthly_Balance'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.NaN <span class="cf">if</span> (x<span class="op">&lt;</span><span class="dv">0</span>) <span class="cf">else</span> x)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Next we replace with mean value of each customers:</li>
</ul>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Annual_Income'</span>] <span class="op">=</span> credit_score[<span class="st">'Annual_Income'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Annual_Income'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Bank_Accounts'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_Bank_Accounts'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_Bank_Accounts'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Credit_Inquiries'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_Credit_Inquiries'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_Credit_Inquiries'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Interest_Rate'</span>] <span class="op">=</span> credit_score[<span class="st">'Interest_Rate'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Interest_Rate'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_of_Loan'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_of_Loan'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_of_Loan'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_of_Delayed_Payment'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_of_Delayed_Payment'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_of_Delayed_Payment'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Num_Credit_Card'</span>] <span class="op">=</span> credit_score[<span class="st">'Num_Credit_Card'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Num_Credit_Card'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Total_EMI_per_month'</span>] <span class="op">=</span> credit_score[<span class="st">'Total_EMI_per_month'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Total_EMI_per_month'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Amount_invested_monthly'</span>] <span class="op">=</span> credit_score[<span class="st">'Amount_invested_monthly'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Amount_invested_monthly'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Monthly_Balance'</span>] <span class="op">=</span> credit_score[<span class="st">'Monthly_Balance'</span>].fillna(credit_score.groupby(<span class="st">'Customer_ID'</span>)[<span class="st">'Monthly_Balance'</span>].transform(<span class="kw">lambda</span> x: x.fillna(x.astype(<span class="st">'float64'</span>).mean())))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>After treating the outliers, variables distribution looks like this</li>
</ul>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>figure, axis <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot histograms</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>, <span class="dv">0</span>].hist(credit_score.Annual_Income, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>, <span class="dv">1</span>].hist(credit_score.Num_Bank_Accounts, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>, <span class="dv">2</span>].hist(credit_score.Num_Credit_Inquiries, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>, <span class="dv">0</span>].hist(credit_score.Interest_Rate, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>, <span class="dv">1</span>].hist(credit_score.Num_of_Loan, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>, <span class="dv">2</span>].hist(credit_score.Num_of_Delayed_Payment, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">2</span>, <span class="dv">0</span>].hist(credit_score.Num_Credit_Card, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">2</span>, <span class="dv">1</span>].hist(credit_score.Total_EMI_per_month, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">2</span>, <span class="dv">2</span>].hist(credit_score.Amount_invested_monthly, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">3</span>, <span class="dv">0</span>].hist(credit_score.Monthly_Balance, color<span class="op">=</span><span class="st">"mediumturquoise"</span>, edgecolor<span class="op">=</span><span class="st">"white"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set titles</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Annual Income'</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Number of Bank Accounts'</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Number of Credit Inquiries'</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'Interest Rate'</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Number of Loans'</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>, <span class="dv">2</span>].set_title(<span class="st">'Number of Delayed Payments'</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Number of Credit Cards'</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Total EMI per Month'</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">2</span>, <span class="dv">2</span>].set_title(<span class="st">'Amount Invested Monthly'</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">3</span>, <span class="dv">0</span>].set_title(<span class="st">'Monthly Balance'</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust spacing between subplots</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>figure.tight_layout()</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="RRproj_files/figure-html/cell-21-output-1.png" width="1142" height="1141"></p>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>credit_score.isna().<span class="bu">sum</span>()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#credit_score = credit_score.dropna(axis=0, how='any')</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(credit_score.shape)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>credit_score.head()</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(46826, 25)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Customer_ID</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Occupation</th>
<th data-quarto-table-cell-role="th">Annual_Income</th>
<th data-quarto-table-cell-role="th">Monthly_Inhand_Salary</th>
<th data-quarto-table-cell-role="th">Num_Bank_Accounts</th>
<th data-quarto-table-cell-role="th">Num_Credit_Card</th>
<th data-quarto-table-cell-role="th">Interest_Rate</th>
<th data-quarto-table-cell-role="th">Num_of_Loan</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Credit_Mix</th>
<th data-quarto-table-cell-role="th">Outstanding_Debt</th>
<th data-quarto-table-cell-role="th">Credit_Utilization_Ratio</th>
<th data-quarto-table-cell-role="th">Credit_History_Age</th>
<th data-quarto-table-cell-role="th">Payment_of_Min_Amount</th>
<th data-quarto-table-cell-role="th">Total_EMI_per_month</th>
<th data-quarto-table-cell-role="th">Amount_invested_monthly</th>
<th data-quarto-table-cell-role="th">Payment_Behaviour</th>
<th data-quarto-table-cell-role="th">Monthly_Balance</th>
<th data-quarto-table-cell-role="th">Credit_Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CUS_0xd40</td>
<td>January</td>
<td>23.0</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>26.822620</td>
<td>22 Years and 1 Months</td>
<td>No</td>
<td>49.574949</td>
<td>80.415295</td>
<td>High_spent_Small_value_payments</td>
<td>312.494089</td>
<td>Good</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUS_0xd40</td>
<td>February</td>
<td>23.0</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>31.944960</td>
<td>22 Years and 3 Months</td>
<td>No</td>
<td>49.574949</td>
<td>118.280222</td>
<td>Low_spent_Large_value_payments</td>
<td>284.629162</td>
<td>Good</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUS_0xd40</td>
<td>March</td>
<td>23.0</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>28.609352</td>
<td>22 Years and 3 Months</td>
<td>No</td>
<td>49.574949</td>
<td>81.699521</td>
<td>Low_spent_Medium_value_payments</td>
<td>331.209863</td>
<td>Good</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUS_0xd40</td>
<td>April</td>
<td>23.0</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>31.377862</td>
<td>22 Years and 4 Months</td>
<td>No</td>
<td>49.574949</td>
<td>199.458074</td>
<td>Low_spent_Small_value_payments</td>
<td>223.451310</td>
<td>Good</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUS_0xd40</td>
<td>May</td>
<td>23.0</td>
<td>Scientist</td>
<td>19114.12</td>
<td>1824.843333</td>
<td>3.0</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>...</td>
<td>Good</td>
<td>809.98</td>
<td>24.797347</td>
<td>22 Years and 5 Months</td>
<td>No</td>
<td>49.574949</td>
<td>41.420153</td>
<td>High_spent_Medium_value_payments</td>
<td>341.489231</td>
<td>Good</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
</section>
<section id="normalization-other-variables" class="level4">
<h4 class="anchored" data-anchor-id="normalization-other-variables">Normalization &amp; Other variables</h4>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># substr month from date string data</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Month_Converter(x): </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> pd.notnull(x):</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    num1 <span class="op">=</span> <span class="bu">int</span>(x.split(<span class="st">' '</span>)[<span class="dv">0</span>])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    num2 <span class="op">=</span> <span class="bu">int</span>(x.split(<span class="st">' '</span>)[<span class="dv">3</span>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (num1<span class="op">*</span><span class="dv">12</span>)<span class="op">+</span>num2</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Credit_History_Age'</span>] <span class="op">=</span> credit_score.Credit_History_Age.<span class="bu">apply</span>(<span class="kw">lambda</span> x: Month_Converter(x)).astype(<span class="bu">float</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Type_of_Loan'</span>] <span class="op">=</span> credit_score[<span class="st">'Type_of_Loan'</span>].astype(<span class="st">'str'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.lower().replace(<span class="st">'and '</span>, <span class="st">''</span>).replace(<span class="st">', '</span>, <span class="st">','</span>).strip() <span class="cf">if</span> pd.notna(x) <span class="cf">else</span> x)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy variable for each explanatory variables that includes more than 2 kind of value</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'auto'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"auto"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'debt_consolidation'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"debt"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'mortgage'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"mortgage"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'home_equity'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"home"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'personal'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"personal"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'student'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"student"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'credit_builder'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"credit-builder"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'payday'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"payday"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'not_specified'</span>] <span class="op">=</span> np.where(credit_score[<span class="st">'Type_of_Loan'</span>].<span class="bu">str</span>.contains(<span class="st">"not specified"</span>),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalization</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>credit_score.Annual_Income <span class="op">=</span> scale(credit_score.Annual_Income)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>credit_score.Monthly_Inhand_Salary <span class="op">=</span> scale(credit_score.Monthly_Inhand_Salary)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>credit_score.Num_Bank_Accounts <span class="op">=</span> scale(credit_score.Num_Bank_Accounts)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>credit_score.Num_Credit_Card <span class="op">=</span> scale(credit_score.Num_Credit_Card)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>credit_score.Interest_Rate <span class="op">=</span> scale(credit_score.Interest_Rate)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>credit_score.Num_of_Loan <span class="op">=</span> scale(credit_score.Num_of_Loan)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>credit_score.Delay_from_due_date <span class="op">=</span> scale(credit_score.Delay_from_due_date)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>credit_score.Num_of_Delayed_Payment <span class="op">=</span> scale(credit_score.Num_of_Delayed_Payment)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>credit_score.Changed_Credit_Limit <span class="op">=</span> scale(credit_score.Changed_Credit_Limit)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>credit_score.Num_Credit_Inquiries <span class="op">=</span> scale(credit_score.Num_Credit_Inquiries)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>credit_score.Outstanding_Debt <span class="op">=</span> scale(credit_score.Outstanding_Debt)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>credit_score.Credit_Utilization_Ratio <span class="op">=</span> scale(credit_score.Credit_Utilization_Ratio)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>credit_score.Credit_History_Age <span class="op">=</span> scale(credit_score.Credit_History_Age)</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>credit_score.Total_EMI_per_month <span class="op">=</span> scale(credit_score.Total_EMI_per_month)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>credit_score.Amount_invested_monthly <span class="op">=</span> scale(credit_score.Amount_invested_monthly)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>credit_score.Monthly_Balance <span class="op">=</span> scale(credit_score.Monthly_Balance)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Spent'</span>] <span class="op">=</span> credit_score[<span class="st">'Payment_Behaviour'</span>].<span class="bu">str</span>.split(<span class="st">'_'</span>, expand<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>credit_score[<span class="st">'Payment'</span>] <span class="op">=</span> credit_score[<span class="st">'Payment_Behaviour'</span>].<span class="bu">str</span>.split(<span class="st">'_'</span>, expand<span class="op">=</span><span class="va">True</span>)[<span class="dv">2</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>credit_score <span class="op">=</span> credit_score.dropna(axis<span class="op">=</span><span class="dv">0</span>, how<span class="op">=</span><span class="st">'any'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(credit_score.shape)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>credit_score.head()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(41902, 36)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Customer_ID</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Occupation</th>
<th data-quarto-table-cell-role="th">Annual_Income</th>
<th data-quarto-table-cell-role="th">Monthly_Inhand_Salary</th>
<th data-quarto-table-cell-role="th">Num_Bank_Accounts</th>
<th data-quarto-table-cell-role="th">Num_Credit_Card</th>
<th data-quarto-table-cell-role="th">Interest_Rate</th>
<th data-quarto-table-cell-role="th">Num_of_Loan</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">debt_consolidation</th>
<th data-quarto-table-cell-role="th">mortgage</th>
<th data-quarto-table-cell-role="th">home_equity</th>
<th data-quarto-table-cell-role="th">personal</th>
<th data-quarto-table-cell-role="th">student</th>
<th data-quarto-table-cell-role="th">credit_builder</th>
<th data-quarto-table-cell-role="th">payday</th>
<th data-quarto-table-cell-role="th">not_specified</th>
<th data-quarto-table-cell-role="th">Spent</th>
<th data-quarto-table-cell-role="th">Payment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CUS_0xd40</td>
<td>January</td>
<td>23.0</td>
<td>Scientist</td>
<td>-0.801448</td>
<td>-0.715537</td>
<td>-0.83093</td>
<td>-0.740111</td>
<td>-1.275923</td>
<td>0.086548</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>High</td>
<td>Small</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CUS_0xd40</td>
<td>February</td>
<td>23.0</td>
<td>Scientist</td>
<td>-0.801448</td>
<td>-0.715537</td>
<td>-0.83093</td>
<td>-0.740111</td>
<td>-1.275923</td>
<td>0.086548</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Low</td>
<td>Large</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CUS_0xd40</td>
<td>March</td>
<td>23.0</td>
<td>Scientist</td>
<td>-0.801448</td>
<td>-0.715537</td>
<td>-0.83093</td>
<td>-0.740111</td>
<td>-1.275923</td>
<td>0.086548</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Low</td>
<td>Medium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CUS_0xd40</td>
<td>April</td>
<td>23.0</td>
<td>Scientist</td>
<td>-0.801448</td>
<td>-0.715537</td>
<td>-0.83093</td>
<td>-0.740111</td>
<td>-1.275923</td>
<td>0.086548</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Low</td>
<td>Small</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CUS_0xd40</td>
<td>May</td>
<td>23.0</td>
<td>Scientist</td>
<td>-0.801448</td>
<td>-0.715537</td>
<td>-0.83093</td>
<td>-0.740111</td>
<td>-1.275923</td>
<td>0.086548</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>High</td>
<td>Medium</td>
</tr>
</tbody>
</table>

<p>5 rows × 36 columns</p>
</div>
</div>
</div>
<p>After done the data preprocessing step we are left with <strong>44’111</strong> observations. Then we divided the data set into training and testing sample by 7:3 ratio. Testing data set has <strong>13’233</strong> observations and Training data set has <strong>30’878</strong> observations.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>credit_score</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>data_test,data_train <span class="op">=</span> train_test_split(data, test_size<span class="op">=</span><span class="fl">0.7</span>, random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Testing data set: </span><span class="ch">\n</span><span class="st">"</span>, data_test.shape)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training data set: </span><span class="ch">\n</span><span class="st">"</span>,data_train.shape)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing data set: 
 (12570, 36)
Training data set: 
 (29332, 36)</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="data-exploration-feature-selection" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration-feature-selection">Data Exploration &amp; Feature Selection</h2>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df_groups <span class="op">=</span> data_train[<span class="st">'Credit_Score'</span>].value_counts()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#create bar plot with custom aesthetics</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>df_groups.plot(kind<span class="op">=</span><span class="st">'bar'</span>, title<span class="op">=</span><span class="st">'Credit Scoring'</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>               ylabel<span class="op">=</span><span class="st">'Count'</span>, xlabel<span class="op">=</span><span class="st">'Category'</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#rotate x-axis ticks vertically</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>(array([0, 1]), [Text(0, 0, 'Poor'), Text(1, 0, 'Good')])</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="RRproj_files/figure-html/cell-26-output-2.png" width="610" height="449"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>